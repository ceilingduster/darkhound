---
id: linux_malware_indicators
name: Linux Malware Indicators
description: Scan for common malware artifacts â€” suspicious files in temp dirs, known backdoor ports, webshells, and encoded payloads
os_types: [linux]
tags: [malware, T1059, T1105, T1027, execution]
severity_hint: critical
---

## Steps

### check_suspicious_temp_files
**description**: Look for executable or script files in temporary directories
**command**: `find /tmp /var/tmp /dev/shm -type f \( -executable -o -name "*.sh" -o -name "*.py" -o -name "*.pl" -o -name "*.elf" \) 2>/dev/null`
**timeout**: 15
**requires_sudo**: false

### check_webshells
**description**: Search web directories for potential webshell files
**command**: `find /var/www /srv/http /var/nginx -type f -name "*.php" -newer /etc/hostname 2>/dev/null | head -20; find /var/www -name "*.php" -exec grep -lE "eval|base64_decode|system|passthru|shell_exec" {} + 2>/dev/null | head -10`
**timeout**: 20
**requires_sudo**: false

### check_base64_in_scripts
**description**: Search for base64-encoded payloads in scripts and configs
**command**: `grep -rl "base64" /tmp /var/tmp /etc/cron.d /var/spool/cron 2>/dev/null | head -10`
**timeout**: 15
**requires_sudo**: false

### check_suspicious_binaries_proc
**description**: Find running processes whose binary path is missing or in unusual locations
**command**: `ls -la /proc/*/exe 2>/dev/null | grep -vE "/usr/|/bin/|/sbin/|/lib/" | grep -v "No such" | head -20`
**timeout**: 15
**requires_sudo**: true

### check_known_backdoor_ports
**description**: Check for processes listening on known backdoor/RAT ports
**command**: `ss -tlnp 2>/dev/null | grep -E ":(4242|4444|5555|6666|1337|31337|12345|9001|9002|8443)" `
**timeout**: 10
**requires_sudo**: false

### check_recently_created_binaries
**description**: Find binaries created in the last 24 hours in non-standard locations
**command**: `find /tmp /var/tmp /dev/shm /opt /home -type f -executable -ctime 0 2>/dev/null | head -20`
**timeout**: 15
**requires_sudo**: false

### check_suspicious_environment
**description**: Look for suspicious environment variables across all processes
**command**: `cat /proc/*/environ 2>/dev/null | tr '\0' '\n' | grep -iE "LD_PRELOAD|LD_LIBRARY|HISTFILE=/dev" | sort -u | head -10`
**timeout**: 15
**requires_sudo**: true

### check_open_reverse_shells
**description**: Detect active reverse shell patterns in process list
**command**: `ps aux 2>/dev/null | grep -iE "bash -i|/dev/tcp|nc -e|ncat -e|socat.*exec|python.*socket" | grep -v grep`
**timeout**: 10
**requires_sudo**: false
